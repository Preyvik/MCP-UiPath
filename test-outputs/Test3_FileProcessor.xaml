<?xml version='1.0' encoding='utf-8'?>
<Activity xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities" xmlns:s="clr-namespace:System;assembly=System.Private.CoreLib" xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation" xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=System.Private.CoreLib" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=System.Private.CoreLib" xmlns:sd1="clr-namespace:System.Drawing;assembly=System.Drawing.Primitives" xmlns:sd2="clr-namespace:System.Drawing;assembly=System.Drawing.Common" xmlns:sd="clr-namespace:System.Data;assembly=System.Data.Common" xmlns:ue="clr-namespace:UiPath.Excel;assembly=UiPath.Excel.Activities" xmlns:ueab="clr-namespace:UiPath.Excel.Activities.Business;assembly=UiPath.Excel.Activities" xmlns:ui="http://schemas.uipath.com/workflow/activities" xmlns:uix="http://schemas.uipath.com/workflow/activities/uix" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" mc:Ignorable="sap sap2010" x:Class="Test3_FileProcessor"><TextExpression.NamespacesForImplementation><sco:Collection x:TypeArguments="x:String"><x:String>Microsoft.VisualBasic</x:String><x:String>Microsoft.VisualBasic.Activities</x:String><x:String>System</x:String><x:String>System.Activities</x:String><x:String>System.Activities.Expressions</x:String><x:String>System.Activities.Statements</x:String><x:String>System.Activities.Validation</x:String><x:String>System.Activities.XamlIntegration</x:String><x:String>System.Collections</x:String><x:String>System.Collections.Generic</x:String><x:String>System.Collections.ObjectModel</x:String><x:String>System.Data</x:String><x:String>System.Diagnostics</x:String><x:String>System.Drawing</x:String><x:String>System.IO</x:String><x:String>System.Linq</x:String><x:String>System.Net.Mail</x:String><x:String>System.Windows</x:String><x:String>System.Windows.Markup</x:String><x:String>System.Xml</x:String><x:String>System.Xml.Linq</x:String><x:String>UiPath.Core</x:String><x:String>UiPath.Core.Activities</x:String><x:String>UiPath.Excel</x:String><x:String>UiPath.Excel.Activities</x:String><x:String>UiPath.Excel.Activities.Business</x:String><x:String>UiPath.UIAutomationNext.Activities</x:String><x:String>UiPath.UIAutomationNext.Enums</x:String></sco:Collection></TextExpression.NamespacesForImplementation><TextExpression.ReferencesForImplementation><sco:Collection x:TypeArguments="AssemblyReference"><AssemblyReference>Microsoft.VisualBasic</AssemblyReference><AssemblyReference>System</AssemblyReference><AssemblyReference>System.Activities</AssemblyReference><AssemblyReference>System.Core</AssemblyReference><AssemblyReference>System.Data</AssemblyReference><AssemblyReference>System.Drawing</AssemblyReference><AssemblyReference>System.Linq</AssemblyReference><AssemblyReference>System.Private.CoreLib</AssemblyReference><AssemblyReference>System.Xml</AssemblyReference><AssemblyReference>System.Xml.Linq</AssemblyReference><AssemblyReference>UiPath.System.Activities</AssemblyReference><AssemblyReference>mscorlib</AssemblyReference></sco:Collection></TextExpression.ReferencesForImplementation><x:Members><x:Property Name="in_FilePaths" Type="InArgument(scg:List(x:String))" /><x:Property Name="in_MaxRetries" Type="InArgument(x:Int32)" /><x:Property Name="out_ProcessedCount" Type="OutArgument(x:Int32)" /></x:Members><mva:VisualBasic.Settings><mva:VisualBasicSettings /></mva:VisualBasic.Settings><Sequence DisplayName="Resilient File Processor" sap:VirtualizedContainerService.HintSize="400,200" sap2010:WorkflowViewState.IdRef="Sequence_1"><Sequence.Variables><Variable x:TypeArguments="x:Int32" Name="processedCount" Default="0" /><Variable x:TypeArguments="x:String" Name="currentFile" /><Variable x:TypeArguments="x:Int32" Name="retryCount" Default="0" /><Variable x:TypeArguments="x:Boolean" Name="keepRetrying" Default="True" /></Sequence.Variables><ui:LogMessage DisplayName="Log Start Processing" Level="Info" Message="[&quot;Starting file processing&quot;]" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="LogMessage_1" /><ui:ForEach x:TypeArguments="x:String" DisplayName="Process Each File" CurrentIndex="{x:Null}" Values="[in_FilePaths]" sap:VirtualizedContainerService.HintSize="518,1098" sap2010:WorkflowViewState.IdRef="ForEach_1"><ui:ForEach.Body><ActivityAction x:TypeArguments="x:String"><ActivityAction.Argument><DelegateInArgument x:TypeArguments="x:String" Name="filePath" /></ActivityAction.Argument><TryCatch DisplayName="Try Process File" sap:VirtualizedContainerService.HintSize="456,713" sap2010:WorkflowViewState.IdRef="TryCatch_1"><TryCatch.Try><Sequence DisplayName="Process Single File" sap:VirtualizedContainerService.HintSize="400,200" sap2010:WorkflowViewState.IdRef="Sequence_2"><Assign DisplayName="Set Current File" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_1"><Assign.To><OutArgument x:TypeArguments="x:String">[currentFile]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:String">[filePath]</InArgument></Assign.Value></Assign><Assign DisplayName="Reset Retry Counter" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_2"><Assign.To><OutArgument x:TypeArguments="x:Int32">[retryCount]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Int32">[0]</InArgument></Assign.Value></Assign><Assign DisplayName="Enable Retrying" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_3"><Assign.To><OutArgument x:TypeArguments="x:Boolean">[keepRetrying]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Boolean">[True]</InArgument></Assign.Value></Assign><While DisplayName="Retry Loop" Condition="[keepRetrying AndAlso retryCount &lt; in_MaxRetries]" sap:VirtualizedContainerService.HintSize="514,707" sap2010:WorkflowViewState.IdRef="While_1"><Sequence DisplayName="Retry Body" sap:VirtualizedContainerService.HintSize="400,200" sap2010:WorkflowViewState.IdRef="Sequence_3"><Assign DisplayName="Increment Retry" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_4"><Assign.To><OutArgument x:TypeArguments="x:Int32">[retryCount]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Int32">[retryCount + 1]</InArgument></Assign.Value></Assign><ui:LogMessage DisplayName="Log Attempt" Level="Info" Message="[&quot;Processing &quot; &amp; currentFile &amp; &quot; attempt &quot; &amp; retryCount.ToString]" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="LogMessage_2" /><Assign DisplayName="Stop Retrying" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_5"><Assign.To><OutArgument x:TypeArguments="x:Boolean">[keepRetrying]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Boolean">[False]</InArgument></Assign.Value></Assign><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState></Sequence><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState></While><Assign DisplayName="Increment Processed" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_6"><Assign.To><OutArgument x:TypeArguments="x:Int32">[processedCount]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Int32">[processedCount + 1]</InArgument></Assign.Value></Assign><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState></Sequence></TryCatch.Try><TryCatch.Catches><Catch x:TypeArguments="Exception" sap:VirtualizedContainerService.HintSize="422,528" sap2010:WorkflowViewState.IdRef="Catch_1"><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean><x:Boolean x:Key="IsPinned">false</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState><ActivityAction x:TypeArguments="Exception"><ActivityAction.Argument><DelegateInArgument x:TypeArguments="Exception" Name="ex" /></ActivityAction.Argument><Sequence DisplayName="Handle File Error" sap:VirtualizedContainerService.HintSize="400,200" sap2010:WorkflowViewState.IdRef="Sequence_4"><ui:LogMessage DisplayName="Log File Error" Level="Error" Message="[&quot;Error processing &quot; &amp; currentFile &amp; &quot;: &quot; &amp; ex.Message]" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="LogMessage_3" /><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState></Sequence></ActivityAction></Catch></TryCatch.Catches></TryCatch></ActivityAction></ui:ForEach.Body></ui:ForEach><Assign DisplayName="Set Output Count" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="Assign_7"><Assign.To><OutArgument x:TypeArguments="x:Int32">[out_ProcessedCount]</OutArgument></Assign.To><Assign.Value><InArgument x:TypeArguments="x:Int32">[processedCount]</InArgument></Assign.Value></Assign><ui:LogMessage DisplayName="Log Complete" Level="Info" Message="[&quot;Completed. Processed &quot; &amp; processedCount.ToString &amp; &quot; files&quot;]" sap:VirtualizedContainerService.HintSize="262,60" sap2010:WorkflowViewState.IdRef="LogMessage_4" /><sap:WorkflowViewStateService.ViewState><scg:Dictionary x:TypeArguments="x:String, x:Object"><x:Boolean x:Key="IsExpanded">true</x:Boolean></scg:Dictionary></sap:WorkflowViewStateService.ViewState></Sequence></Activity>